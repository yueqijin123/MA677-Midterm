"0","# Simulate samples from exponential distribution"
"0","set.seed(1)"
"0","n_samples <- 10000"
"0","samples <- matrix(rexp(n_samples * 5), ncol = 5)"
"0",""
"0","# Calculate the second order statistic"
"0","sec_vals <- apply(samples, 1, function(x) sort(x)[2])"
"0","data_sec <- data.frame(value = sec_vals)"
"0",""
"0","# Theoretical density"
"0","theoretical_density <- function(x) { 20 * exp(-4 * x) * (1 - exp(-x)) }"
"0",""
"0","# Plot"
"0","ggplot(data_sec, aes(x = value)) +"
"0","  geom_histogram(aes(y = after_stat(density)), binwidth = 0.03, fill = ""#FFD60A"", color = ""black"") +"
"0","  stat_function(fun = theoretical_density, color = ""#003566"", linewidth = 1) +"
"0","  labs(title = ""Density of Second Order Statistic from Exponential Distribution"","
"0","       x = ""Value"","
"0","       y = ""Density"") +"
"0","  theme_minimal() +"
"0","  theme(plot.title = element_text(hjust = 0.5))"
